<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
        <head>
                <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
                <title></title>
		<link rel='stylesheet' href='style.css' type='text/css' />
        </head>
        <body>
                <div id="wrapper">
                        <div id="left-block">
                                <div id="terminal-header">
                                        <h1>
                                                securely erase unused blocks in a partition
                                        </h1>
                                </div>
                                <div class="terminal-display one-liner" id="terminal-display-main">
                                        <div class="line command">
                                                # cd $partition; dd if=/dev/zero of=ShredUnusedBlocks bs=512M; shred -vzu ShredUnusedBlocks
                                        </div>
                                        <div class="sample-output c5 output">
                                                <pre>
# Example showing the /boot partition. Note command is run as root.

# cd /boot; dd if=/dev/zero of=ShredUnusedBlocks bs=512M; shred -vzu ShredUnusedBlocks
dd: writing `ShredUnusedBlocks': No space left on device
1+0 records in
0+0 records out
231747584 bytes (232 MB) copied, 8.21679 s, 28.2 MB/s
shred: ShredUnusedBlocks: pass 1/4 (random)...
shred: ShredUnusedBlocks: pass 1/4 (random)...20MiB/222MiB 9%
shred: ShredUnusedBlocks: pass 1/4 (random)...40MiB/222MiB 18%
shred: ShredUnusedBlocks: pass 1/4 (random)...60MiB/222MiB 27%
shred: ShredUnusedBlocks: pass 1/4 (random)...80MiB/222MiB 36%
shred: ShredUnusedBlocks: pass 1/4 (random)...100MiB/222MiB 45%
shred: ShredUnusedBlocks: pass 1/4 (random)...120MiB/222MiB 54%
shred: ShredUnusedBlocks: pass 1/4 (random)...140MiB/222MiB 63%
shred: ShredUnusedBlocks: pass 1/4 (random)...160MiB/222MiB 72%
shred: ShredUnusedBlocks: pass 1/4 (random)...180MiB/222MiB 81%
shred: ShredUnusedBlocks: pass 1/4 (random)...200MiB/222MiB 90%
shred: ShredUnusedBlocks: pass 1/4 (random)...220MiB/222MiB 99%
shred: ShredUnusedBlocks: pass 1/4 (random)...222MiB/222MiB 100%
shred: ShredUnusedBlocks: pass 2/4 (random)...
shred: ShredUnusedBlocks: pass 2/4 (random)...18MiB/222MiB 8%
shred: ShredUnusedBlocks: pass 2/4 (random)...39MiB/222MiB 17%
shred: ShredUnusedBlocks: pass 2/4 (random)...59MiB/222MiB 26%
shred: ShredUnusedBlocks: pass 2/4 (random)...79MiB/222MiB 35%
shred: ShredUnusedBlocks: pass 2/4 (random)...98MiB/222MiB 44%
shred: ShredUnusedBlocks: pass 2/4 (random)...118MiB/222MiB 53%
shred: ShredUnusedBlocks: pass 2/4 (random)...139MiB/222MiB 62%
shred: ShredUnusedBlocks: pass 2/4 (random)...158MiB/222MiB 71%
shred: ShredUnusedBlocks: pass 2/4 (random)...179MiB/222MiB 81%
shred: ShredUnusedBlocks: pass 2/4 (random)...199MiB/222MiB 90%
shred: ShredUnusedBlocks: pass 2/4 (random)...219MiB/222MiB 99%
shred: ShredUnusedBlocks: pass 2/4 (random)...222MiB/222MiB 100%
shred: ShredUnusedBlocks: pass 3/4 (random)...
shred: ShredUnusedBlocks: pass 3/4 (random)...17MiB/222MiB 8%
shred: ShredUnusedBlocks: pass 3/4 (random)...38MiB/222MiB 17%
shred: ShredUnusedBlocks: pass 3/4 (random)...58MiB/222MiB 26%
shred: ShredUnusedBlocks: pass 3/4 (random)...78MiB/222MiB 35%
shred: ShredUnusedBlocks: pass 3/4 (random)...97MiB/222MiB 44%
shred: ShredUnusedBlocks: pass 3/4 (random)...117MiB/222MiB 53%
shred: ShredUnusedBlocks: pass 3/4 (random)...137MiB/222MiB 62%
shred: ShredUnusedBlocks: pass 3/4 (random)...157MiB/222MiB 71%
shred: ShredUnusedBlocks: pass 3/4 (random)...177MiB/222MiB 80%
shred: ShredUnusedBlocks: pass 3/4 (random)...197MiB/222MiB 89%
shred: ShredUnusedBlocks: pass 3/4 (random)...217MiB/222MiB 98%
shred: ShredUnusedBlocks: pass 3/4 (random)...222MiB/222MiB 100%
shred: ShredUnusedBlocks: pass 4/4 (000000)...
shred: ShredUnusedBlocks: removing
shred: ShredUnusedBlocks: renamed to 00000000000000000
shred: 00000000000000000: renamed to 0000000000000000
shred: 0000000000000000: renamed to 000000000000000
shred: 000000000000000: renamed to 00000000000000
shred: 00000000000000: renamed to 0000000000000
shred: 0000000000000: renamed to 000000000000
shred: 000000000000: renamed to 00000000000
shred: 00000000000: renamed to 0000000000
shred: 0000000000: renamed to 000000000
shred: 000000000: renamed to 00000000
shred: 00000000: renamed to 0000000
shred: 0000000: renamed to 000000
shred: 000000: renamed to 00000
shred: 00000: renamed to 0000
shred: 0000: renamed to 000
shred: 000: renamed to 00
shred: 00: renamed to 0
shred: ShredUnusedBlocks: removed
</pre>
                                        </div>
                                        <div class="details">

                                                <div class="description">
                                                        <p>
                                                                This command securely erases all the unused blocks on a partition.
                                                        </p>
                                                        <p>
                                                                The unused blocks are the "free space" on the partition.
                                                        </p>
                                                        <p>
                                                                Some of these blocks will contain data from previously deleted files.
                                                        </p>
                                                        <p>
                                                                You might want to use this if you are given access to an old computer and you do not know its provenance.
                                                        </p>
                                                        <p>
                                                                The command could be used while booted from a LiveCD to clear freespace space on old HD.
                                                        </p>
                                                        <p>
                                                                On modern Linux LiveCDs, the "ntfs-3g" system provides ReadWrite access to NTFS partitions thus enabling this method to also be used on Wind'ohs drives.
                                                        </p>
                                                        <p>
                                                                NB depending on the size of the partition, this command could take a while to complete.
                                                        </p>
                                                </div>
                                        </div>
                                </div>
                                <h3>
                                        Alternatives
                                </h3>
                                <div class="terminal-display"></div>
                                <h3>
                                        What others think
                                </h3>
                                <div id="comments">
                                        <div class="comment comment0 body">
                                                <p>
                                                        It looks like you forgot to specify the 'dd' part before if=/dev/zero. Also, be careful when running this on the partition where /home or /tmp is mounted because it can cause weird hangups when applications can no longer create temporary files, like when starting an X session.
                                                </p>
                                        </div>
                                        <div class="comment comment1 body">
                                                <p>
                                                        @bwoodacre
                                                </p>
                                                <p>
                                                        Thanks for pointing out the missing "dd". Fixed now.
                                                </p>
                                                <p>
                                                        You are also right about needing to be careful about filling /tmp. Hence the mention of LiveCD.
                                                </p>
                                        </div>
                                        <div class="comment comment0 body">
                                                <p>
                                                        Doesn't handle slack in the last block of a file. Also other space is probably not overwritten on journalling filesystems.
                                                </p>
                                        </div>
                                        <div class="comment comment1 body">
                                                <p>
                                                        fwiw dban linux is supposed to be the ultimate shredder...
                                                </p>
                                        </div>
                                        <div class="comment comment0 body">
                                                <p>
                                                        Good point pixelbeat. In more words: in some filesystems, a 10 byte file still takes up (say, for instance) 4069 bytes (4K) of physical disk space. If you want to leave the existing files on the filesystem untouched, then this slack space is unwritable at the filesystem level. Something like ext2 would behave this way, but reiser3 packs many small files into the same block. So expanding a giant file and shredding it is a great start if you want/need to do things in place, but you aren't guaranteed to shred 100% of the unused disk bytes unless you use something at the block-device level like dban.
                                                </p>
                                        </div>
                                        <div class="comment comment1 body">
                                                <p>
                                                        @pixelbeat
                                                </p>
                                                <p>
                                                        Where is the slack?
                                                </p>
                                                <p>
                                                        The "dd" creates a single file from all the unused blocks in the partition in a file called "ShredUnusedBlocks".
                                                </p>
                                                <p>
                                                        So the end of this file is the end of the last unused block.
                                                </p>
                                                <p>
                                                        You can use the "df" command after the "dd" to verify 100% of the space in the partition is used up when the "ShredUnusedBlocks" file is created.
                                                </p>
                                                <p>
                                                        Regarding the journal, what do you think the journal will be full of? I think it will be mostly full of writes of random data from the shred command. If the default number of overwrites from shred is not considered enough, it can be increased with the "-n" (or "--iterations=n") option.
                                                </p>
                                                <p>
                                                        Example: specifying "-n16" for 16 iterations:
                                                </p>
                                                <p>
                                                        cd /boot; dd if=/dev/zero of=ShredUnusedBlocks bs=512M; shred -vzu -n16 ShredUnusedBlocks
                                                </p>
                                        </div>
                                </div>
                        </div>
                </div>
        </body>
</html>

Check a server is up. If it isn't mail me.

Terminal - Check a server is up. If it isn't mail me.
ping -q -c1 -w3 brandx.jp.sme 2&>1 /dev/null || echo brandx.jp.sme ping
failed | mail -ne -s'Server unavailable' joker@jp.co.uk

 An email saying "brandx.jp.sme ping failed"

User: mccalni
Check a server is up. If it isn't mail me.

Joker wants an email if the Brand X server is down. Set a cron job for
every 5 mins with this line and he gets an email when/if a ping takes
longer than 3 seconds.




curl -fs brandx.jp.sme 2&>1 > /dev/null || echo brandx.jp.sme ping failed
| mail -ne -s'Server unavailable' joker@jp.co.uk

 An email saying "brandx.jp.sme ping failed"

User: mccalni
Check a server is up. If it isn't mail me.

Alternative to the ping check if your firewall blocks ping. Uses curl to
get the landing page silently, or fail with an error code. You can
probably do this with wget as well.

ping -q -c1 -w3 server.example.com >& /dev/null || echo server.example.com
ping failed | mail -ne -s'Server unavailable' admin@example.com

User: unixmonkey11948
Check a server is up. If it isn't mail me.

For some reason the 2&>1 does not work for me, but the shorter
stdout/stderr redirection >& works perfectly (Ubuntu 10.04).

nc -zw2 www.example.com 80 || echo http service is down | mail -s 'http is
down' admin@example.com

User: putnamhill
Check a server is up. If it isn't mail me.

This version uses netcat to check a particular service.


seem not correct.

When i execute "ping -q -c1 -w3

i got exit status 0 and when executing "ping -q -c1 -w3 www.google.com
2&>1 /dev/null" i got 1 ....

Comment by zhuzhixin 51 weeks and 6 days ago

zhuzhixin, what distro you using? This using bash on Jaunty.

From the ping man page

...

ping is part of iputils package and the latest versions are available in
source form at http://www.skbuff.net/iputils/iputils-current.tar.bz2.

...

-q Quiet output....

-c count

Stop after sending count ECHO_REQUEST packets. With deadline option, ping
waits for count ECHO_REPLY packets, until the timeout expires.

-w deadline

Specify a timeout, in seconds, before ping exits regardless of how many
packets have been sent or received....

Comment by mccalni 51 weeks ago

I think maybe your firewall eats ping replies? Try an internal machine
address and/or something you know you get ping replies from. My corporate
firewall eats pings from google, yahoo, et al, but at home I can ping them
fine.

Comment by mccalni 50 weeks and 5 days ago


<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Strict//EN'
    'http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en' lang='en'>
  <head>
    <link rel='stylesheet' href='style.css' type='text/css' />
    <title>
      command line fu
    </title>
  </head>
  <body>
    <div class='terminal'>
      <div class='author'>
        kamathln
      </div>
      <div class='summary'>
        Cleanup firefox's database.
      </div>
      <div class='command'>
        pgrep -u `id -u` firefox-bin || find ~/.mozilla/firefox -name '*.sqlite'|(while read -e f; do echo 'vacuum;'|sqlite3 "$f" ; done)
      </div>
      <div class='desc'>
        <p>
          Sqlite database keeps collecting cruft as time passes, which can be cleaned by the 'vacuum;' command. This command cleans up the cruft in all sqlite files relating to the user you have logged in as. This command has to be run when firefox is not running, or it will exit displaying the pid of the firefox running.
        </p>
      </div>
    </div>
    <div class='terminal'>
      <div class='author'>
        syssyphus
      </div>
      <div class='summary'>
        <a href="/commands/view/3277/cleanup-firefoxs-database." title="Find out what others think of this command">Cleanup firefox's database.</a>
      </div>
      <div class='command'>
        find ~/.mozilla/firefox/ -type f -name "*.sqlite" -exec sqlite3 {} VACUUM \;
      </div>
    </div>
    <div class='terminal'>
      <div class='author'>
        stanishjohnd
      </div>
      <div class='summary'>
        <a href="/commands/view/3286/cleanup-firefoxs-database." title="Find out what others think of this command">Cleanup firefox's database.</a>
      </div>
      <div class='command'>
        find ~/Library/Application\ Support/Firefox/ -type f -name "*.sqlite" -exec sqlite3 {} VACUUM \;
      </div>
      <div class='desc'>
        <p>
          For Mac OS X users only
        </p>
      </div>
    </div>
    <div class='comment'>
      <div class='author'>
        bwoodacre
      </div>
      <div class='text'>
        <p>
          The first part isn't strictly necessary, right? Since sqlite will fail gracefully if firefox is already running? I think you could use find to do everything, with an admittedly odd-looking -exec argument:
        </p><code>find ~/.mozilla/firefox -name "*.sqlite" -exec bash -c "&lt;&lt;&lt;'vacuum;' sqlite {}" \;</code>
        <p>
          using "here documents" to substitute a string for stdin. Putting echo before bash helps to see what commands would be run without running them :-).
        </p>
      </div>
    </div>
    <div class='comment'>
      <div class='author'>
        kamathln
      </div>
      <div class='text'>
        <p>
          Yeah. I guess so. I was ujst being extra carefull with the pid part.
        </p>
        <p>
          With the "do everything with find, I do completely agree with you. And it is better too, because it will correctly handle if there is a newline in the file name. Whereas my code will fail miserably.
        </p>
        <p>
          But I would like to point out that you need to be carefull with your quotes.
        </p>
        <p>
          find ~/.mozilla/firefox -name '*.sqlite' -exec bash -c "
        </p>
      </div>
    </div>
    <div class='comment'>
      <div class='author'>
        nbv4
      </div>
      <div class='text'>
        <p>
          Wow, all this seemed to do it delete my profile. -1
        </p>
      </div>
    </div>
    <div class='comment'>
      <div class='author'>
        kamathln
      </div>
      <div class='text'>
        <p>
          @nvb4 delete your profile?? wierd. That should never happen unless your sqlite files were corrupted in the first place. Did you use a wrong version of sqlite?
        </p>
      </div>
    </div>
  </body>
</html>

Create a persistent connection to a machine

Terminal - Create a persistent connection to a machine
ssh -MNf <user>@<host>

User: raphink
Create a persistent connection to a machine

Create a persistent SSH connection to the host in the background. Combine
this with settings in your ~/.ssh/config:

Host host

ControlPath ~/.ssh/master-%r@%h:%p

ControlMaster no

All the SSH connections to the machine will then go through the persisten
SSH socket. This is very useful if you are using SSH to synchronize files
(using rsync/sftp/cvs/svn) on a regular basis because it won't create a
new socket each time to open an ssh connection.

I had tried this before running a command on one SSH and backgrounding it
(ssh

user@host "command" &), but this is much nicer.

You can also set the options on the command line if you only want the
control process for a single job:

ssh -o "ControlPath ~/.ssh/master-%r_%h_%p" -MNf

scp -o "ControlMaster no" -o "ControlPath ~/.ssh/master-%r_%h_%p"
user@host:file .

(ControlMaster no is default, so that option probably isn't necessary for
the scp, but its included here for completeness)

Comment by sud0er 84 weeks and 6 days ago

Yes, ControlMaster no is default indeed. It can be useful in other cases
to use auto instead, if you don't care to have a socket always open, but
you might have several SSH connections following one another. In that
case, you don't need the "ssh -MNf" command, and the first SSH command to
be launched will create the socket which will be used by the following
commands.

Comment by raphink 84 weeks and 6 days ago

